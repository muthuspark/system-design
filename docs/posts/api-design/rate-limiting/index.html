<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rate Limiting – System Design Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-5c1aa57916d092647891b8a3fe59897e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="../../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Rate Limiting – System Design Notes">
<meta property="og:description" content="">
<meta property="og:site_name" content="System Design Notes">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">System Design Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/muthuspark"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/krimuthu"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rate Limiting</h1>
  <div class="quarto-categories">
    <div class="quarto-category">API Design</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Rate limiting is a crucial technique for protecting your APIs and servers from overload. It’s the practice of controlling the rate at which a client can access a resource. Without it, a malicious actor or even a simple surge in legitimate traffic can bring your system to its knees. This post will delve deep into rate limiting, exploring its different approaches, implementation strategies, and best practices.</p>
<section id="why-is-rate-limiting-important" class="level2">
<h2 data-anchor-id="why-is-rate-limiting-important">Why is Rate Limiting Important?</h2>
<p>The importance of rate limiting stems from several key factors:</p>
<ul>
<li><p><strong>Preventing Denial of Service (DoS) attacks:</strong> A common attack vector involves flooding a server with requests, rendering it unavailable to legitimate users. Rate limiting acts as a strong defense mechanism against these attacks.</p></li>
<li><p><strong>Resource Protection:</strong> Even without malicious intent, uncontrolled access to resources can deplete server capacity, leading to slowdowns and performance degradation for all users. Rate limiting ensures fair resource allocation.</p></li>
<li><p><strong>Cost Optimization:</strong> Excessive requests can translate into higher infrastructure costs. Rate limiting helps manage expenses by controlling resource consumption.</p></li>
<li><p><strong>API Stability:</strong> Rate limiting ensures the stability and reliability of your APIs, preventing unexpected outages and maintaining a positive user experience.</p></li>
</ul>
</section>
<section id="types-of-rate-limiting-algorithms" class="level2">
<h2 data-anchor-id="types-of-rate-limiting-algorithms">Types of Rate Limiting Algorithms</h2>
<p>Several algorithms can be implemented for rate limiting, each with its own strengths and weaknesses:</p>
<p><strong>1. Fixed Window:</strong></p>
<p>This is the simplest approach. Requests are counted within a fixed time window (e.g., 1 second, 1 minute). If the count exceeds a predefined limit within the window, further requests are rejected.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Client Request] --&gt; B{Counter &lt; Limit?};
    B -- Yes --&gt; C[Request Allowed];
    B -- No --&gt; D[Request Rejected];
    C --&gt; E[Resource Access];
    E --&gt; F[Window Reset];
    F --&gt; B;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Limitations:</strong> This approach can suffer from the “burstiness problem.” A large burst of requests at the end of a window can still exceed the limit, even if the average request rate is acceptable.</p>
<p><strong>2. Sliding Window:</strong></p>
<p>This improves upon the fixed window by allowing requests to be distributed more evenly over time. Requests are counted within a sliding window that moves across time. Requests outside the window are not counted.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Client Request] --&gt; B(Sliding Window);
    B -- Request in Window &amp; Count &lt; Limit --&gt; C[Request Allowed];
    B -- Request in Window &amp; Count &gt;= Limit --&gt; D[Request Rejected];
    B -- Request Outside Window --&gt; E[Ignore Request];
    C --&gt; F[Resource Access];
    F --&gt; G[Counter Update];
    G --&gt; B;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>3. Leaky Bucket:</strong></p>
<p>This algorithm allows a certain number of requests per unit of time to “leak” through. If the rate of incoming requests exceeds the “leak rate,” requests are queued until space becomes available. This is good for smoothing out bursts of requests.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Client Request] --&gt; B(Leaky Bucket);
    B -- Bucket Full --&gt; C[Request Rejected];
    B -- Bucket Not Full --&gt; D[Request Accepted];
    D --&gt; E[Resource Access];
    E --&gt; F[Token Release];
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>4. Token Bucket:</strong></p>
<p>Similar to the Leaky Bucket, but instead of a bucket filling with requests, a bucket fills with tokens at a regular rate. Each request consumes a token. This approach allows for bursts of requests as long as there are sufficient tokens available.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Client Request] --&gt; B{Token Available?};
    B -- Yes --&gt; C[Request Allowed];
    B -- No --&gt; D[Request Rejected];
    C --&gt; E[Resource Access];
    E --&gt; F[Token Consumption];
    F --&gt; G[Token Generation];
    G --&gt; B;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="implementation-strategies" class="level2">
<h2 data-anchor-id="implementation-strategies">Implementation Strategies</h2>
<p>Rate limiting can be implemented at different layers of your application:</p>
<ul>
<li><p><strong>Network Layer:</strong> Using tools like Nginx or HAProxy to configure rate limiting rules based on IP addresses or other headers.</p></li>
<li><p><strong>Application Layer:</strong> Integrating rate limiting logic directly into your application code, typically using libraries or frameworks. This allows for more granular control based on user accounts or API keys.</p></li>
<li><p><strong>Database Layer:</strong> Some databases provide built-in rate limiting features.</p></li>
</ul>
<p><strong>Example (Python with <code>ratelimit</code> library):</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ratelimit <span class="im">import</span> limits, RateLimitException</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">@limits</span>(calls<span class="op">=</span><span class="dv">2</span>, period<span class="op">=</span><span class="dv">60</span>) <span class="co"># 2 calls per minute</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> my_api_endpoint(request):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Your API logic here</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"Success!"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  result <span class="op">=</span> my_api_endpoint(request)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(result)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> RateLimitException:</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"Rate limit exceeded"</span>)</span></code></pre></div>
</section>
<section id="best-practices" class="level2">
<h2 data-anchor-id="best-practices">Best Practices</h2>
<ul>
<li><p><strong>Choose the right algorithm:</strong> Consider the characteristics of your application and traffic patterns when selecting a rate limiting algorithm.</p></li>
<li><p><strong>Configure appropriate limits:</strong> Set limits that balance the needs of your application with the expected traffic volume.</p></li>
<li><p><strong>Implement robust error handling:</strong> Provide informative error messages to clients when rate limits are exceeded.</p></li>
<li><p><strong>Consider different granularity levels:</strong> Limit requests based on IP address, user ID, API key, or any combination thereof.</p></li>
</ul>


</section>

</main> <!-- /main -->
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>“Copyright 2025, Muthukrishnan”</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>