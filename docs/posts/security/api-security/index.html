<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>API Security – System Design Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-5c1aa57916d092647891b8a3fe59897e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-ee5e052b81fc94e1f9bb89611f476562.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="../../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="API Security – System Design Notes">
<meta property="og:description" content="">
<meta property="og:site_name" content="System Design Notes">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">System Design Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/muthuspark"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/krimuthu"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">API Security</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Security</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>APIs (Application Programming Interfaces) are the backbone of modern software, enabling seamless communication between different applications and services. However, their ubiquitous nature and the sensitive data they often handle make them prime targets for cyberattacks. Securing your APIs is important not only for protecting your own systems but also for safeguarding the data of your users and clients. This guide explores various aspects of API security, providing practical strategies and best practices.</p>
<section id="understanding-api-vulnerabilities" class="level2">
<h2 data-anchor-id="understanding-api-vulnerabilities">Understanding API Vulnerabilities</h2>
<p>Before understanding the common vulnerabilities that APIs face, it’s essential to understand the common vulnerabilities that APIs face. Many vulnerabilities stem from poor design and implementation. Here are some key areas of concern:</p>
<ul>
<li><p><strong>Authentication &amp; Authorization:</strong> Failing to properly authenticate users and authorize their access to specific resources is a major vulnerability. Attackers can exploit weak authentication mechanisms or unauthorized access to sensitive data.</p></li>
<li><p><strong>Injection Attacks:</strong> SQL injection, command injection, and cross-site scripting (XSS) attacks can compromise API functionality and data integrity. These attacks typically involve injecting malicious code into API requests.</p></li>
<li><p><strong>Broken Object Level Authorization:</strong> This occurs when an API doesn’t properly validate user permissions at the object level. For example, a user might be able to access data they shouldn’t have access to based on their role.</p></li>
<li><p><strong>Data Exposure:</strong> APIs might inadvertently expose sensitive data, such as user credentials or personally identifiable information (PII), if not properly secured.</p></li>
<li><p><strong>Denial of Service (DoS):</strong> DoS attacks flood an API with requests, making it unavailable to legitimate users.</p></li>
</ul>
</section>
<section id="implementing-api-security-measures" class="level2">
<h2 data-anchor-id="implementing-api-security-measures">Implementing API Security Measures</h2>
<p>Securing your APIs requires a multi-layered approach, combining various security controls and practices.</p>
<section id="authentication-authorization" class="level3">
<h3 data-anchor-id="authentication-authorization">1. Authentication &amp; Authorization</h3>
<p>Robust authentication and authorization are fundamental. Consider these strategies:</p>
<ul>
<li><strong>OAuth 2.0:</strong> A widely used authorization framework that provides secure access to protected resources. It allows users to grant applications access to their data without sharing their credentials.</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[User] --&gt; B(Authorization Server);
    B --&gt; C[Resource Server];
    A --&gt; D(Application);
    D --&gt; B;
    D --&gt; C;
    style B fill:#ccf,stroke:#333,stroke-width:2px
    style C fill:#ccf,stroke:#333,stroke-width:2px
    subgraph OAuth 2.0 Flow
        B -- Access Token --&gt; D
        D -- Access Token --&gt; C
    end
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li><p><strong>JSON Web Tokens (JWT):</strong> Compact and self-contained tokens that encode user information and claims. They are used for authentication and authorization and are often used in conjunction with OAuth 2.0.</p></li>
<li><p><strong>API Keys &amp; Secrets:</strong> While simpler, API keys and secrets should be used with caution. They are less secure than OAuth 2.0 and JWT but can be suitable for less sensitive APIs. Implement rotation strategies.</p></li>
</ul>
</section>
<section id="input-validation-sanitization" class="level3">
<h3 data-anchor-id="input-validation-sanitization">2. Input Validation &amp; Sanitization</h3>
<p>Always validate and sanitize all input received by your API. This helps prevent injection attacks:</p>
<ul>
<li><p><strong>Parameter Validation:</strong> Check the data type, length, and format of all parameters.</p></li>
<li><p><strong>Data Sanitization:</strong> Escape or encode user-supplied data before using it in queries or displaying it on the client-side. This prevents XSS attacks.</p></li>
</ul>
<p>Example (Python with Flask):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> flask <span class="im">import</span> Flask, request</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> Flask(<span class="va">__name__</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="at">@app.route</span>(<span class="st">'/api/example'</span>, methods<span class="op">=</span>[<span class="st">'POST'</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> example_api():</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    user_input <span class="op">=</span> request.form.get(<span class="st">'input'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> user_input:</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>sanitized_input <span class="op">=</span> user_input.replace(<span class="st">"'"</span>, <span class="st">"''"</span>)  <span class="co"># Simple example, use a dedicated library for sanitization</span></span></code></pre></div>
<pre><code>    # ... use sanitized_input in your code ...
return 'OK'</code></pre>
<pre><code>
### 3. Rate Limiting

Implement rate limiting to prevent DoS attacks and abuse. This involves restricting the number of requests a client can make within a given time period.

```{mermaid}

graph LR
    Client["Client"] --&gt; |"API Request"| Gate["Rate Limiter"]
    Gate --&gt; |"Under Limit"| API["API"]
    Gate --&gt; |"Over Limit"| Block["429 Too Many Requests"]
    API --&gt; |"Response"| Client
    
    classDef limiter fill:#f9f,stroke:#333,stroke-width:2px
    class Gate limiter
</code></pre>
</section>
<section id="output-encoding" class="level3">
<h3 data-anchor-id="output-encoding">4. Output Encoding</h3>
<p>Encode all data returned by your API to prevent XSS and other vulnerabilities.</p>
</section>
<section id="security-auditing-monitoring" class="level3">
<h3 data-anchor-id="security-auditing-monitoring">5. Security Auditing &amp; Monitoring</h3>
<p>Regularly audit your APIs for security vulnerabilities and monitor for suspicious activity. Use security tools and logging to detect and respond to threats promptly.</p>
</section>
<section id="api-versioning" class="level3">
<h3 data-anchor-id="api-versioning">6. API Versioning</h3>
<p>Implement API versioning to allow for updates and improvements without breaking existing integrations. This also helps in managing the lifecycle of security patches and updates.</p>
</section>
<section id="https" class="level3">
<h3 data-anchor-id="https">7. HTTPS</h3>
<p>Always use HTTPS to encrypt communication between clients and your API.</p>
</section>
</section>
<section id="advanced-security-techniques" class="level2">
<h2 data-anchor-id="advanced-security-techniques">Advanced Security Techniques</h2>
<ul>
<li><p><strong>Web Application Firewall (WAF):</strong> A WAF can filter malicious traffic and protect your API from various attacks.</p></li>
<li><p><strong>Security Information and Event Management (SIEM):</strong> A SIEM system can collect and analyze security logs from various sources, including your API, to detect and respond to security incidents.</p></li>
</ul>
</section>
<section id="api-gateway-security" class="level2">
<h2 data-anchor-id="api-gateway-security">API Gateway Security</h2>
<p>API gateways are important for centralizing API management and security. They offer features like authentication, authorization, rate limiting, and request transformation.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    Client["Client"] --&gt; Gateway["API Gateway"]
    
    subgraph Security Layers
        Gateway --&gt; Auth["Authentication\nAPI Keys/JWT"]
        Auth --&gt; Rate["Rate Limiting"]
        Rate --&gt; WAF["Web Application\nFirewall"]
        WAF --&gt; SSL["SSL/TLS\nTermination"]
    end
    
    SSL --&gt; Backend["Backend Services"]
    
    classDef security fill:#f9f,stroke:#333,stroke-width:2px
    class Auth,Rate,WAF,SSL security
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Diagram shows security layers in API Gateway:</p>
<ol type="1">
<li>Authentication (API Keys/JWT)</li>
<li>Rate Limiting</li>
<li>Web Application Firewall</li>
<li>SSL/TLS Termination</li>
<li>Connection to Backend Services</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/system-design\.muthu\.co\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Muthukrishnan</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>